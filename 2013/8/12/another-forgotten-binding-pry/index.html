<!DOCTYPE html>
<html><head><title>Ryan Virtual Machine - Another forgotten binding.pry</title><meta charset="UTF-8"><meta content="width=device-width, initial-scale=1.0" name="viewport"><link href="//netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css" rel="stylesheet" type="text/css"><link href="/assets/stylesheets/app-7aa60b63b8d93ef71683e320be0044f3.css" rel="stylesheet" type="text/css"><link href="/assets/images/vm.png" rel="icon" type="image/png"></head><body id="page"><div class="container"><header><h1 id="site-title"><a href="/">Ryan Virtual Machine</a></h1><ul class="navigation" id="main-navigation"><li><a href="/bio/">Bio</a></li><li><a href="/attributions/">Attributions</a></li></ul><div class="clearfix"></div></header><div id="content"><h1>Another forgotten binding.pry</h1><p>Tools like <a href="http://pryrepl.org/">pry</a> and <a href="http://devdocs.io/javascript/statements/debugger">debugger</a> are almost indispensable once you have gotten used to them, however I have yet to meet a user who has not forgotten them in a commit.</p><p>If you are a very careful person you might proof read your diffs before committing. While I generally follow this advice it can be quite easy to miss something, like a <code>binding.pry</code> you were using to debug/test your changes. You&rsquo;ll probably catch this before you deploy.</p><p>If you don&rsquo;t though&hellip;</p><p>Well, let&rsquo;s just avoid those potentially timeouts devastating in prod by utilizing a <em>pre-commit hook</em>. For those who do not know, <a href="http://git-scm.com/book/en/Customizing-Git-Git-Hooks">git hooks</a> are a mechanism available to git users which executes scripts when &ldquo;certain important actions occur&rdquo; with your git repository. One of these important actions is commiting. Git provides several hooks around this action, one of which is the aforementioned <em>pre-commit hook</em>.</p>
<script src="https://gist.github.com/RyanMcG/5775028.js"></script><p>This is just a simple (and suboptimal) shell script that when run at the root of a Rails project will attempt to use <a href="https://www.kernel.org/pub/software/scm/git/docs/git-grep.html">git&rsquo;s grep</a> to find instances of <code>debugger</code> or <code>binding.pry</code> in your source. If one is found it exits non-zero which indicates to git that the in-progress commit should be cancelled! Mistake avoided!</p><p>If you have pre-commit hook returning a false positive (returning non-zero when it should not be) you may always bypass a failing pre-commit hook by adding a <code>--no-verify</code> (or <code>-n</code> for lazy users) to your commit command.</p><h2>But wait, there&rsquo;s more</h2><p>As an added bonus this pre-commit hook also checks for diff artifacts like <code>&lt;&lt;&lt;&lt;&lt;&lt;&lt;</code>, <code>&gt;&gt;&gt;&gt;&gt;&gt;&gt;</code> and <code>=======</code>. This is to ensure you do not try to commit merge conflicts either.</p><p>This is just one more optional check you can add to your pre-commit hook. Perhaps, you want to stop calls to <code>console.log</code> in JavaScript source too.</p><h2>Installation</h2><p>To install this hook you&rsquo;ll have to do something like the following.</p>
<pre><code>curl https://gist.github.com/RyanMcG/5775028/raw/rails-pre-commit
chmod +x rails-pre-commit
mv rails-pre-commit path/to/your/rails/root/.git/hooks/pre-commit
</code></pre><h2>Modularity</h2><p>Complex hooks can often develop over time. Some modularity is often wanted to make adding new components to a hook easier and to make sharing easier. While git does help with this on its own there are various projects which do.</p><p>One such project, aptly named <a href="https://github.com/icefox/git-hooks">git-hooks</a>, allows many scripts to be specifies for the same action by using subdirectories with the names of the hook inside of a folder called <code>git_hooks</code> at the root of the repository. Source controlling the hooks is often desirable so you can share them with the rest of your team.</p></div><footer><div class="col-md-6" id="cc"><a href="http://creativecommons.org/licenses/by-sa/3.0/deed.en_US" id="cc-logo" rel="license"><img alt="Creative Commons License" src="http://i.creativecommons.org/l/by-sa/3.0/88x31.png"></a><p id="cc-text">This website and its content are licensed under the <a href="http://creativecommons.org/licenses/by-sa/3.0/deed.en_US" rel="license">Creative Commons Attribution-ShareAlike 3.0 Unported License</a> by Ryan V McGowan except where specified otherwise.</p></div><div class="col-md-2" id="donate"><a class="coinbase-button" data-button-style="donation_small" data-code="24680873e506998448b8c15fb4f9846e" href="https://coinbase.com/checkouts/24680873e506998448b8c15fb4f9846e">Donate Bitcoins</a><script src="https://coinbase.com/assets/button.js" type="text/javascript"></script></div><div class="col-md-4" id="contacts"><div class="row"><div class="contact col-xs-4"><a class="mbtn" href="https://twitter.com/Ryan_VM" title="Ryan_VM on twitter"><i class="fa fa-4x fa-twitter"></i></a></div><div class="contact col-xs-4"><a class="mbtn" href="https://github.com/RyanMcG" title="RyanMcG on github"><i class="fa fa-4x fa-github"></i></a></div><div class="contact col-xs-4"><a class="mbtn" href="mailto:ryan@ryanmcg.com" title="Email me at ryan@ryanmcg.com"><i class="fa fa-4x fa-envelope"></i></a></div></div></div><p id="credit">This website was <a href="https://github.com/RyanMcG/incise">incised</a>.</p></footer></div><script src="http://code.jquery.com/jquery-2.0.3.min.js" type="text/javascript"></script><script src="/assets/javascripts/app-cd4d2bd0232733e89138fa7be0c67e42.js" type="text/javascript"></script></body></html>